# æ§åˆ¶å°è¾“å‡ºç¤ºä¾‹

æœ¬æ–‡æ¡£å±•ç¤ºäº†ç™»å½•å’Œæ³¨å†Œæ—¶åç«¯æ§åˆ¶å°çš„è¾“å‡ºç¤ºä¾‹ï¼Œæ–¹ä¾¿æ‚¨è°ƒè¯•å’ŒéªŒè¯åŠŸèƒ½ã€‚

## ğŸ“ ç™»å½•è¯·æ±‚è¾“å‡º

### æˆåŠŸç™»å½•
```
==================================================
ã€ç™»å½•è¯·æ±‚ã€‘
ç”¨æˆ·å: admin
å¯†ç : *********
ç™»å½•æ—¶é—´: 2025-11-10 15:30:45
==================================================
âœ… ç™»å½•æˆåŠŸ: ç”¨æˆ·ç±»å‹=admin
```

### ç™»å½•å¤±è´¥
```
==================================================
ã€ç™»å½•è¯·æ±‚ã€‘
ç”¨æˆ·å: wronguser
å¯†ç : ******
ç™»å½•æ—¶é—´: 2025-11-10 15:31:20
==================================================
âŒ ç™»å½•å¤±è´¥: ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯
```

## ğŸ“ æ³¨å†Œè¯·æ±‚è¾“å‡º

### 1. ä¼ä¸šç”¨æˆ·æ³¨å†Œ
```
============================================================
ã€æ³¨å†Œè¯·æ±‚ã€‘
æ³¨å†Œæ—¶é—´: 2025-11-10 15:32:10
ç”¨æˆ·ç±»å‹: enterprise
ç”¨æˆ·å: test_enterprise
å¯†ç : ******
å§“å: å¼ ä¸‰
æ‰‹æœºå·: 13800138000
é‚®ç®±: test@example.com

ã€ä¼ä¸šç”¨æˆ·ä¿¡æ¯ã€‘
ä¼ä¸šåç§°: æµ‹è¯•ä¼ä¸šæœ‰é™å…¬å¸
èŒä½: å®‰å…¨ç»ç†
============================================================
```

### 2. æ‰¿åŒ…å•†ç”¨æˆ·æ³¨å†Œ
```
============================================================
ã€æ³¨å†Œè¯·æ±‚ã€‘
æ³¨å†Œæ—¶é—´: 2025-11-10 15:33:25
ç”¨æˆ·ç±»å‹: contractor
ç”¨æˆ·å: test_contractor
å¯†ç : ******
å§“å: æå››
æ‰‹æœºå·: 13900139000
é‚®ç®±: lisi@example.com

ã€æ‰¿åŒ…å•†ç”¨æˆ·ä¿¡æ¯ã€‘
æ‰¿åŒ…å•†å…¬å¸åç§°: æµ‹è¯•æ‰¿åŒ…å•†å…¬å¸
============================================================
```

### 3. ç³»ç»Ÿç®¡ç†å‘˜æ³¨å†Œ
```
============================================================
ã€æ³¨å†Œè¯·æ±‚ã€‘
æ³¨å†Œæ—¶é—´: 2025-11-10 15:34:40
ç”¨æˆ·ç±»å‹: admin
ç”¨æˆ·å: test_admin
å¯†ç : ******
å§“å: ç‹äº”
æ‰‹æœºå·: 13700137000
é‚®ç®±: admin@example.com

ã€ç³»ç»Ÿç®¡ç†å‘˜ä¿¡æ¯ã€‘
ç®¡ç†å‘˜æˆæƒç : ADMIN2024
æ‰€å±éƒ¨é—¨: ç³»ç»Ÿç®¡ç†éƒ¨
============================================================
```

### 4. æ³¨å†Œæ—¶æœªå¡«å†™å¯é€‰å­—æ®µ
```
============================================================
ã€æ³¨å†Œè¯·æ±‚ã€‘
æ³¨å†Œæ—¶é—´: 2025-11-10 15:35:55
ç”¨æˆ·ç±»å‹: enterprise
ç”¨æˆ·å: test_user2
å¯†ç : ******
å§“å: èµµå…­
æ‰‹æœºå·: 13600136000
é‚®ç®±: æœªå¡«å†™

ã€ä¼ä¸šç”¨æˆ·ä¿¡æ¯ã€‘
ä¼ä¸šåç§°: å¦ä¸€å®¶ä¼ä¸š
èŒä½: æœªå¡«å†™
============================================================
```

## ğŸ” å¦‚ä½•æŸ¥çœ‹è¿™äº›è¾“å‡º

### æ–¹æ³•1ï¼šç›´æ¥è¿è¡ŒæœåŠ¡
```bash
cd /Users/dubin/work/ehs_sys
source /opt/anaconda3/bin/activate ehs_env
uvicorn main:app --host 0.0.0.0 --port 8100 --reload
```
ç„¶ååœ¨æµè§ˆå™¨æˆ–ä½¿ç”¨curlå‘é€è¯·æ±‚ï¼Œæ§åˆ¶å°ä¼šå®æ—¶æ˜¾ç¤ºè¾“å‡ºã€‚

### æ–¹æ³•2ï¼šæŸ¥çœ‹æ—¥å¿—æ–‡ä»¶
å¦‚æœæ‚¨é…ç½®äº†æ—¥å¿—æ–‡ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹ï¼š
```bash
tail -f server.log
```

## ğŸ§ª æµ‹è¯•å‘½ä»¤

### æµ‹è¯•ä¼ä¸šç”¨æˆ·æ³¨å†Œ
```bash
curl -X POST "http://localhost:8100/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "test_enterprise",
    "password": "123456",
    "userType": "enterprise",
    "name": "å¼ ä¸‰",
    "phone": "13800138000",
    "email": "test@example.com",
    "companyName": "æµ‹è¯•ä¼ä¸šæœ‰é™å…¬å¸",
    "position": "å®‰å…¨ç»ç†"
  }'
```

### æµ‹è¯•æ‰¿åŒ…å•†ç”¨æˆ·æ³¨å†Œ
```bash
curl -X POST "http://localhost:8100/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "test_contractor",
    "password": "123456",
    "userType": "contractor",
    "name": "æå››",
    "phone": "13900139000",
    "email": "lisi@example.com",
    "contractorCompanyName": "æµ‹è¯•æ‰¿åŒ…å•†å…¬å¸"
  }'
```

### æµ‹è¯•ç³»ç»Ÿç®¡ç†å‘˜æ³¨å†Œ
```bash
curl -X POST "http://localhost:8100/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "test_admin",
    "password": "123456",
    "userType": "admin",
    "name": "ç‹äº”",
    "phone": "13700137000",
    "email": "admin@example.com",
    "adminCode": "ADMIN2024",
    "department": "ç³»ç»Ÿç®¡ç†éƒ¨"
  }'
```

### æµ‹è¯•ç™»å½•
```bash
curl -X POST "http://localhost:8100/token" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=admin&password=admin123"
```

## ğŸ“Š è¾“å‡ºæ ¼å¼è¯´æ˜

### åˆ†éš”çº¿
- `=` å·åˆ†éš”çº¿é•¿åº¦ä¸º50æˆ–60ä¸ªå­—ç¬¦
- ç”¨äºæ¸…æ™°åœ°åˆ†éš”ä¸åŒçš„è¯·æ±‚

### æ ‡é¢˜æ ¼å¼
- ä½¿ç”¨ä¸­æ–‡æ–¹æ‹¬å· `ã€ã€‘` æ ‡è¯†ä¸åŒçš„éƒ¨åˆ†
- ä¾‹å¦‚ï¼š`ã€ç™»å½•è¯·æ±‚ã€‘`ã€`ã€ä¼ä¸šç”¨æˆ·ä¿¡æ¯ã€‘`

### å­—æ®µæ˜¾ç¤º
- æ ¼å¼ï¼š`å­—æ®µå: å€¼`
- å¯†ç å­—æ®µæ˜¾ç¤ºä¸º `*` å·
- æœªå¡«å†™çš„å¯é€‰å­—æ®µæ˜¾ç¤ºä¸º `æœªå¡«å†™`

### çŠ¶æ€æ ‡è¯†
- âœ… è¡¨ç¤ºæˆåŠŸ
- âŒ è¡¨ç¤ºå¤±è´¥

## ğŸ’¡ è°ƒè¯•æŠ€å·§

1. **æŸ¥çœ‹å®Œæ•´è¯·æ±‚æ•°æ®**ï¼šæ‰€æœ‰å­—æ®µéƒ½ä¼šè¢«æ‰“å°ï¼Œæ–¹ä¾¿éªŒè¯å‰ç«¯ä¼ é€’çš„æ•°æ®æ˜¯å¦æ­£ç¡®

2. **å¯†ç å®‰å…¨**ï¼šå¯†ç ä¸ä¼šæ˜æ–‡æ‰“å°ï¼Œåªæ˜¾ç¤ºé•¿åº¦å¯¹åº”çš„ `*` å·

3. **æ—¶é—´æˆ³**ï¼šæ¯ä¸ªè¯·æ±‚éƒ½æœ‰æ—¶é—´æˆ³ï¼Œæ–¹ä¾¿è¿½è¸ª

4. **åˆ†ç±»æ˜¾ç¤º**ï¼šæ ¹æ®ç”¨æˆ·ç±»å‹åˆ†åˆ«æ˜¾ç¤ºç‰¹æœ‰å­—æ®µï¼Œä¾¿äºåŒºåˆ†

5. **å¯é€‰å­—æ®µå¤„ç†**ï¼šæœªå¡«å†™çš„å­—æ®µä¼šæ˜¾ç¤º"æœªå¡«å†™"ï¼Œè€Œä¸æ˜¯ç©ºå€¼

## ğŸ”§ è‡ªå®šä¹‰è¾“å‡º

å¦‚æœæ‚¨éœ€è¦ä¿®æ”¹è¾“å‡ºæ ¼å¼ï¼Œå¯ä»¥ç¼–è¾‘ `/routes/auth.py` æ–‡ä»¶ä¸­çš„æ‰“å°è¯­å¥ï¼š

```python
# ç™»å½•è¾“å‡º
print("=" * 50)
print("ã€ç™»å½•è¯·æ±‚ã€‘")
print(f"ç”¨æˆ·å: {form_data.username}")
print(f"å¯†ç : {'*' * len(form_data.password)}")
print(f"ç™»å½•æ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
print("=" * 50)

# æ³¨å†Œè¾“å‡º
print("\n" + "=" * 60)
print("ã€æ³¨å†Œè¯·æ±‚ã€‘")
print(f"æ³¨å†Œæ—¶é—´: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
# ... æ›´å¤šå­—æ®µ ...
```

---

**æç¤º**: è¿™äº›è¾“å‡ºä»…ç”¨äºå¼€å‘å’Œè°ƒè¯•ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨ä¸“ä¸šçš„æ—¥å¿—ç³»ç»Ÿã€‚

